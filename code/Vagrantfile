require File.expand_path(File.join(File.dirname(__FILE__), 'config.rb'))

Vagrant::Config.run do |config|
  config.vm.box = 'precise64'
  config.vm.box_url = 'http://files.vagrantup.com/precise64.box'
  config.vm.host_name = 'development'
  config.vm.customize ['modifyvm', :id, '--name', 'Joomlatools Development']
  config.vm.share_folder 'vagrant', '/tmp/vagrant', File.expand_path(File.dirname(__FILE__))
  
  # Load custom configuration file
  v_config = parse_vagrant_config
  
  if v_config.has_key?('hosts')
    v_config['hosts'].each do |host|
      config.vm.network :hostonly, host['ip']
      config.vm.share_folder host['name'], "/var/www/#{host['name']}/source", File.expand_path(host['path'])
    end
  end

  config.vm.provision :chef_solo do |chef|
    chef.cookbooks_path = 'cookbooks'
    chef.roles_path = 'roles'
    chef.add_role 'default'
  end
end